package gui_control.MovingBarSettingView;

import java.util.ArrayList;

import gui_control.DataHandler.DataHandler;
import gui_control.MovingBarSideModel.MovingBarSideModel;
import gui_control.ScenarioModel.ScenarioModel;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.scene.control.ChoiceBox;
import javafx.scene.control.ColorPicker;
import javafx.scene.control.TextField;
import javafx.scene.input.MouseButton;
import javafx.scene.input.MouseEvent;
import javafx.scene.paint.Color;

public class MovingBarSettingController {
	@FXML
    private ChoiceBox<String> frontScenarioChoicebox;

    @FXML
    private ColorPicker frontDisplayColor;

    @FXML
    private ColorPicker frontReferenceColor;

    @FXML
    private ChoiceBox<String> frontModeChoicebox;

    @FXML
    private TextField frontRefrenceTextfield;

    @FXML
    private TextField frontStepsizeTextfield;

    @FXML
    private ChoiceBox<String> leftScenarioChoicebox;

    @FXML
    private ColorPicker leftDisplayColor;

    @FXML
    private ColorPicker leftReferenceColor;

    @FXML
    private ChoiceBox<String> leftModeChoicebox;

    @FXML
    private TextField leftRefrenceTextfield;

    @FXML
    private TextField leftStepsizeTextfield;

    @FXML
    private ChoiceBox<String> rightScenarioChoicebox;

    @FXML
    private ColorPicker rightDisplayColor;

    @FXML
    private ColorPicker rightReferenceColor;

    @FXML
    private ChoiceBox<String> rightModeChoicebox;

    @FXML
    private TextField rightRefrenceTextfield;

    @FXML
    private TextField rightStepsizeTextfield;

    @FXML
    private ChoiceBox<String> backScenarioChoicebox;

    @FXML
    private ColorPicker backDisplayColor;

    @FXML
    private ColorPicker backReferenceColor;

    @FXML
    private ChoiceBox<String> backModeChoicebox;

    @FXML
    private TextField backRefrenceTextfield;

    @FXML
    private TextField backStepsizeTextfield;
    
    DataHandler dataHandler;
    
    ObservableList<String> scenarios; /*TODO:MODEL*/
    
    ObservableList<String> modes;
    
    @FXML
	private void initialize(){
    	
    	modes = FXCollections.observableArrayList(dataHandler.getModes());
		
    	if(modes!=null){
			frontModeChoicebox.setItems(modes);
			leftModeChoicebox.setItems(modes);
			rightModeChoicebox.setItems(modes);
			backModeChoicebox.setItems(modes);	
		}
    	
		
		if(scenarios != null)frontScenarioChoicebox.setItems(scenarios);
		
		//applyDataFromHandler();
		
	}
    
    public void applyDataFromHandler(){
    	
    	scenarios = scenarioListToNames(dataHandler.getScenarios());
    	
    	MovingBarSideModel frontSide = dataHandler.getFrontSide();
    	frontDisplayColor.setValue(getPaintColor(frontSide.getQuantityColor()));
    	frontReferenceColor.setValue(getPaintColor(frontSide.getReferenceColor()));
    	frontRefrenceTextfield.setText(Integer.toString(frontSide.getReferenceValue()));
    	frontStepsizeTextfield.setText(Integer.toString(frontSide.getStepSize()));
    	
    	MovingBarSideModel leftSide = dataHandler.getLeftSide();
    	leftDisplayColor.setValue(getPaintColor(leftSide.getQuantityColor()));
    	leftReferenceColor.setValue(getPaintColor(leftSide.getReferenceColor()));
    	leftRefrenceTextfield.setText(Integer.toString(leftSide.getReferenceValue()));
    	leftStepsizeTextfield.setText(Integer.toString(leftSide.getStepSize()));
    	
    	MovingBarSideModel rightSide = dataHandler.getRightSide();
    	rightDisplayColor.setValue(getPaintColor(rightSide.getQuantityColor()));
    	rightReferenceColor.setValue(getPaintColor(rightSide.getReferenceColor()));
    	rightRefrenceTextfield.setText(Integer.toString(rightSide.getReferenceValue()));
    	rightStepsizeTextfield.setText(Integer.toString(rightSide.getStepSize()));
    	
    	MovingBarSideModel backSide = dataHandler.getBackSide();
    	backDisplayColor.setValue(getPaintColor(backSide.getQuantityColor()));
    	backReferenceColor.setValue(getPaintColor(backSide.getReferenceColor()));
    	backRefrenceTextfield.setText(Integer.toString(backSide.getReferenceValue()));
    	backStepsizeTextfield.setText(Integer.toString(backSide.getStepSize()));
    	
    }
    
    public void saveData(){
    	int referenceValue= Integer.parseInt(frontRefrenceTextfield.getText());
    	int stepSize= Integer.parseInt(frontStepsizeTextfield.getText());
    	
    	dataHandler.setFrontSide(frontDisplayColor.getValue(), frontReferenceColor.getValue(),
    							referenceValue , stepSize, frontModeChoicebox.getValue());
    }
    
    public void setDataHandler(DataHandler dataHandler){
    	this.dataHandler = dataHandler;
    }
    
    public ObservableList<String> scenarioListToNames(ArrayList<ScenarioModel> scenarios){
    	ArrayList<String> list = new ArrayList<String>();
    	for(ScenarioModel s: scenarios){
    		list.add(s.getName());
    	}
    	
    	return FXCollections.observableArrayList(list);
    }
    
    private static Color getAwtColor(javafx.scene.paint.Color paintColor){
    	
    }
    
    private static Color getPaintColor(java.awt.Color awtColor){
    	int r = awtColor.getRed();
    	int g = awtColor.getGreen();
    	int b = awtColor.getBlue();
    	int a = awtColor.getAlpha();
    	double opacity = a / 255.0 ;
    	return Color.rgb(r, g, b, opacity);
	}
    
}
